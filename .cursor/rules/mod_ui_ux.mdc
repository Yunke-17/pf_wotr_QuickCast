---
description: 提问引导：“关于Mod的UI激活指示器，mod_ui_ux 规则是怎么规定的？”或“我正在实现动态快捷栏，请参考 mod_ui_ux 规则中的描述。” 场景：在实现或修改任何与用户界面相关的部分，或者讨论用户体验问题时
globs: 
alwaysApply: false
---
# Mod UI/UX 设计

该规则详细说明了"法术快速施法系统"Mod 的用户界面 (UI) 和用户体验 (UX) 设计。清晰直观的 UI/UX 是此 Mod 成功的关键。详细信息请参考 `[quickcast.md](mdc:quickcast.md)` 第 4 节 和 `[注意事项.md](mdc:注意事项.md)`。

## 1. 激活状态指示器 (Activation State Indicator)

参考 `[quickcast.md](mdc:quickcast.md)` 第 4.1 节。

*   **必要性**: 必须有清晰的提示告知玩家当前处于哪个快捷施法页模式。
*   **表现形式**: 当快捷施法页被激活或停用时，相关的状态信息（例如："快捷施法: 3环 已激活" 或 "快捷施法: 返回主快捷栏"）将作为一条新的消息被添加到游戏内建的事件日志窗口的"事件"标签页下。
*   **行为**: 当快捷施法页相关的状态发生变化时（激活、停用），对应的消息会出现在事件日志中。

## 2. 动态主快捷栏 (Dynamic Main Hotbar) - 关键交互

参考 `[quickcast.md](mdc:quickcast.md)` 第 4.2 节 和 `[注意事项.md](mdc:注意事项.md)` 第 5 点。

*   **核心机制**: 当一个快捷施法页被激活时，游戏的主快捷栏（游戏画面中底部的那一排）**必须临时改变其显示内容**，以反映当前激活页面的法术绑定情况。
*   **具体表现**: 
    *   例如按下 `Ctrl + 3` (激活3环法术页)：
        *   主快捷栏第 1 个格子（逻辑施法槽位1）：显示绑定到该槽位的 3 环法术图标，并在图标角落或下方显示按键提示 "**[玩家为"行动栏1"在游戏设置中配置的原生快捷键]**" (即该逻辑槽位的"施法键")。
        *   主快捷栏第 2 个格子（逻辑施法槽位2）：显示绑定到该槽位的 3 环法术图标，并显示按键提示 "**[玩家为"行动栏2"在游戏设置中配置的原生快捷键]**"。
        *   以此类推。
    *   对于快捷栏上未绑定法术的逻辑施法槽位，应使用原版操作栏对于未放置内容的显示逻辑（即显示为空）。
*   **恢复**: 当按下"返回键" (`X`) 或通过其他方式返回主快捷栏模式时，主快捷栏**立即恢复**显示其原本由玩家手动配置的内容。
*   **重要性**: 这是提供即时视觉反馈、减少记忆负担、让系统直观易用的核心环节。玩家无需记忆每个环阶每个按键绑的是什么，只需激活页面，看一眼动态变化的快捷栏及其上的原生施法键提示即可。

## 3. 绑定与施法反馈

参考 `[quickcast.md](mdc:quickcast.md)` 第 4.3 节。

*   **绑定反馈**: 在行动栏法术书界面，当鼠标悬停于法术并成功通过"绑定键"将其绑定到快捷施法页的某个逻辑施法槽位时，应有明确反馈：
    *   视觉: 法术图标短暂高亮、闪烁，或旁边出现一个小小的绑定成功标记。
    *   听觉 (可选): 播放一个轻微、确认性的音效。
*   **施法反馈**: 遵循游戏原有的施法动画、音效、目标效果等。Mod 主要确保施法指令的正确发出。

## 4. 操作误触规避与UI调整

参考 `[quickcast.md](mdc:quickcast.md)` 第 4.4 节 和 第 5 节 (UI 显示相关)。

*   **问题**: 防止在战斗中，当鼠标悬停在（行动栏）法术书的法术上时，按下快捷键被误认为设置快捷键而非施法（特指如果"绑定键"和某些游戏功能键重合的情况）。
*   **解决方案 (来自文档)**:
    1.  **UI 位置调整**: Mod 打开的行动栏法术书 UI 必须调整至在战斗中不易意外触碰的位置（例如屏幕左下角）。 (此功能为 `quickcast.md` 的要求)
    2.  **UI 大小调整**: 提供预设的行动栏法术书 UI 样式（行x列，例如 3x5），防止其占据过多屏幕空间。 (此功能为 `quickcast.md` 的要求)
*   **行动栏法术书界面**: 注意与 `[注意事项.md](mdc:注意事项.md)` 第 1 点中提到的"主法术书界面"进行区分。

## 5. 游戏行动栏交互机制利用

参考 `[注意事项.md](mdc:注意事项.md)` 第 2 和 第 5 点。

*   游戏中的行动栏法术书界面（由"**S**"表示）是附属在主行动栏界面上的，可以通过鼠标点击展开/折叠。
*   Mod的动态主快捷栏机制，其核心是**利用游戏原有的主行动栏及其内容显示能力**。当Mod激活一个快捷施法页时：
    1.  Mod在内部逻辑中确定了哪些法术应该显示在哪些逻辑施法槽位上。
    2.  Mod通过代码（例如创建 `QuickCastMechanicActionBarSlotSpell` 实例）将这些法术"放置"到游戏主行动栏对应的 `ActionBarSlotVM` 上。
    3.  游戏UI系统自动渲染这些被放置的内容，包括法术图标和该行动栏格子原生的快捷键提示（即"施法键"）。
*   这并非简单地"切换行动栏页面"，而是更直接地修改当前主行动栏上特定格子的内容以反映Mod的快捷施法页绑定。

